### Problem Statement
Given an array of $4n$ positive integers, determine if they can be used to form $n$ rectangles, all having equal areas.

**Expected Time Complexity:** $O(n \log n)$

**Link:** [Codeforces 1203B - Equal Rectangles](https://codeforces.com/problemset/problem/1203/B)

---

### Quick Takeaway
Observe small examples to find a pattern. Try to formulate an axiom that you can logically prove or disprove to simplify the problem.

---

### Intuition
Since a rectangle requires two pairs of equal sides, every side length must appear an even number of times in the array. To maintain a constant area while forming $n$ rectangles, the smallest available side should always be paired with the largest available side.

---

### Solution
1. **Side Frequency:** Every side length must occur an even number of times because opposite sides of a rectangle are equal.
2. **Greedy Pairing:** Assume the array $a$ (of size $4n$) is sorted. The smallest side $a[0]$ must be paired with the largest side $a[4n-1]$ to form a rectangle.
   - **Proof by Contradiction:** Suppose we pair $a[0]$ with $a[x]$ and $a[4n-1]$ with $a[y]$, where $a[y] > a[0]$ and the areas are equal ($a[0] \cdot a[x] = a[y] \cdot a[4n-1]$). For this to hold with $a[y] > a[0]$, then $a[4n-1]$ would have to be smaller than $a[x]$, which contradicts the fact that $a[4n-1]$ is the largest element.
3. **Induction:** After pairing the smallest and largest available sides (and verifying their counts are sufficient), we can remove them and apply the same logic to the remaining elements.

---

### Code (C++)
```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);

    int test;
    cin >> test;

    while (test--) {
        int n;
        cin >> n;

        vector<int> a(4 * n);
        for (auto &ai : a) cin >> ai;

        sort(a.begin(), a.end());
        
        string res = "YES";
        for (int i = 0, j = 4 * n - 1; i < j; i += 2, j -= 2) {
            if (a[i] != a[i + 1] || a[j] != a[j - 1] || a[i] * a[j] != target_area) {
                res = "NO";
                break;
            }
        }

        cout << res << "\n";
    }
}
```
